
<!DOCTYPE html>
<html class="dark" lang="es">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Panel de control ORM</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet"/>
  <link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:wght,FILL@100..700,0..1&display=swap" rel="stylesheet"/>
  <link rel="stylesheet" href="/public/css/control-panel.css"/>
</head>
<body>
<div class="app-shell">
  <aside class="sidebar">
    <div class="sidebar-header">
      <div class="icon-box"><span class="material-symbols-outlined">database</span></div>
      <div>
        <h1>ORM Control</h1>
        <p>Administrador</p>
      </div>
    </div>
    <nav class="sidebar-nav">
      <a href="#" class="nav-link active" data-section="usuarios"><span class="material-symbols-outlined">person</span>Usuarios</a>
      <a href="#" class="nav-link" data-section="perfiles"><span class="material-symbols-outlined">badge</span>Perfiles</a>
      <a href="#" class="nav-link" data-section="objetos"><span class="material-symbols-outlined">deployed_code</span>Objetos</a>
      <a href="#" class="nav-link" data-section="metodos"><span class="material-symbols-outlined">code</span>Metodos</a>
      <a href="#" class="nav-link" data-section="permisos"><span class="material-symbols-outlined">key</span>Permisos</a>
    </nav>
    <div class="sidebar-footer">
      <button id="logoutBtn" type="button" class="nav-link nav-button"><span class="material-symbols-outlined">logout</span>Cerrar sesion</button>
    </div>
  </aside>

  <main class="main-panel">
    <header class="main-header">
      <div>
        <h2 id="mainTitle">Usuarios</h2>
        <p id="mainSubtitle">Administra cuentas, perfiles y acceso</p>
      </div>
      <div class="status-chip"><span class="status-dot"></span><span>Sistema en linea</span></div>
    </header>

    <div class="panel-content">
      <section id="sec-usuarios" class="module-section">
        <div class="action-bar"><h3>Gestion de usuarios</h3><button class="btn" onclick="resetUserForm()">Limpiar</button></div>
        <form id="userForm" class="form-grid" onsubmit="saveUser(event)">
          <input type="hidden" id="user_id_user"/><input type="hidden" id="user_id_person"/>
          <div class="field"><label>Nombre</label><input id="user_name" required/></div>
          <div class="field"><label>Apellido</label><input id="user_last_name" required/></div>
          <div class="field"><label>Fecha nacimiento</label><input id="user_birth_date" type="date" required/></div>
          <div class="field"><label>Correo</label><input id="user_email" type="email" required/></div>
          <div class="field"><label>Cedula/ID</label><input id="user_number_id" required/></div>
          <div class="field"><label>Contrasena (solo crear)</label><input id="user_password" type="password"/></div>
          <div class="field"><label>Perfiles</label><select id="user_profiles" class="compact-multi-select" multiple size="3"></select></div>
          <div class="field field-full"><button id="userSubmitBtn" class="btn btn-primary" type="submit">Crear usuario</button></div>
        </form>
        <div class="table-wrap"><table class="table" id="usersTable"><thead><tr><th>ID</th><th>Nombre</th><th>Correo</th><th>ID</th><th>Perfil</th><th>Acciones</th></tr></thead><tbody></tbody></table></div>
      </section>

      <section id="sec-perfiles" class="module-section hidden">
        <div class="action-bar"><h3>Gestion de perfiles</h3><button class="btn" onclick="resetProfileForm()">Limpiar</button></div>
        <form id="profileForm" class="form-inline" onsubmit="saveProfile(event)"><input id="profile_id" type="hidden"/><input id="profile_name" placeholder="Nombre del perfil" required/><button id="profileSubmitBtn" class="btn btn-primary" type="submit">Crear perfil</button></form>
        <div class="table-wrap"><table class="table" id="profilesTable"><thead><tr><th>ID</th><th>Perfil</th><th>Acciones</th></tr></thead><tbody></tbody></table></div>
      </section>

      <section id="sec-objetos" class="module-section hidden">
        <div class="action-bar"><h3>Gestion de objetos</h3><button class="btn" onclick="resetObjectForm()">Limpiar</button></div>
        <form id="objectForm" class="form-inline" onsubmit="saveObject(event)"><input id="object_id" type="hidden"/><input id="object_name" placeholder="Nombre del objeto" required/><button id="objectSubmitBtn" class="btn btn-primary" type="submit">Crear objeto</button></form>
        <div class="table-wrap"><table class="table" id="objectsTable"><thead><tr><th>ID</th><th>Objeto</th><th>Acciones</th></tr></thead><tbody></tbody></table></div>
      </section>

      <section id="sec-metodos" class="module-section hidden">
        <div class="action-bar"><h3>Gestion de metodos</h3><button class="btn" onclick="resetMethodForm()">Limpiar</button></div>
        <form id="methodForm" class="form-inline" onsubmit="saveMethod(event)"><input id="method_id" type="hidden"/><input id="method_name" placeholder="Nombre del metodo" required/><select id="method_object_id" required></select><button id="methodSubmitBtn" class="btn btn-primary" type="submit">Crear metodo</button></form>
        <div id="methodsFiltersContainer" class="action-bar filters-bar hidden">
          <div class="filters-grid">
            <div class="field no-margin">
            <label for="methodsFilterMethodName">Filtrar por metodo</label>
            <input id="methodsFilterMethodName" placeholder="Ej: getUsers" oninput="renderMethodsTable()"/>
          </div>
            <div class="field no-margin">
            <label for="methodsFilterObjectName">Filtrar por objeto</label>
            <select id="methodsFilterObjectName" onchange="renderMethodsTable()">
              <option value="">Todos los objetos</option>
            </select>
          </div>
          </div>
          <div class="control-stack">
            <span class="control-caption">Accion</span>
            <button class="btn" type="button" onclick="clearMethodsFilters()">Limpiar filtros</button>
          </div>
        </div>
        <div class="table-wrap"><table class="table" id="methodsTable"><thead><tr><th>ID</th><th>Metodo</th><th>Objeto</th><th>Acciones</th></tr></thead><tbody></tbody></table></div>
      </section>

      <section id="sec-permisos" class="module-section hidden">
        <div class="action-bar">
          <div class="field no-margin">
            <label>Perfil a editar</label>
            <select id="profileSelect" onchange="loadPermissions()"><option value="">Selecciona un perfil</option></select>
          </div>
          <div class="control-stack">
            <span class="control-caption">Accion</span>
            <button id="savePermissionsBtn" class="btn btn-primary" type="button" onclick="savePermissions()">Guardar permisos</button>
          </div>
        </div>
        <div id="emptyState" class="empty-state"><span class="material-symbols-outlined">touch_app</span><p id="emptyStateText">Selecciona un perfil para ver los permisos</p></div>
        <div id="permissionsContainer" class="hidden">
          <div id="permissionsFiltersContainer" class="action-bar filters-bar hidden">
            <div class="filters-grid">
              <div class="field no-margin">
              <label for="permissionsFilterMethodName">Filtrar por metodo</label>
              <input id="permissionsFilterMethodName" placeholder="Ej: getUsers" oninput="renderPermissionsGrid()"/>
            </div>
              <div class="field no-margin">
              <label for="permissionsFilterObjectName">Filtrar por objeto</label>
              <select id="permissionsFilterObjectName" onchange="renderPermissionsGrid()">
                <option value="">Todos los objetos</option>
              </select>
            </div>
            </div>
            <div class="control-stack">
              <span class="control-caption">Accion</span>
              <button class="btn" type="button" onclick="clearPermissionsFilters()">Limpiar filtros</button>
            </div>
          </div>
          <div id="permissionsTitleContainer" class="perm-head hidden"><h3>Metodos disponibles</h3><span>Selecciona metodos permitidos</span></div>
          <div id="methodsGrid" class="permissions-grid"></div>
        </div>
      </section>
    </div>
  </main>
</div>
<div id="feedbackModal" class="feedback-modal hidden" role="dialog" aria-modal="true" aria-labelledby="feedbackTitle">
  <div class="feedback-card">
    <h3 id="feedbackTitle">Mensaje</h3>
    <p id="feedbackMessage"></p>
    <div class="feedback-actions">
      <button id="feedbackCancelBtn" type="button" class="btn hidden">Cancelar</button>
      <button id="feedbackConfirmBtn" type="button" class="btn btn-primary">Aceptar</button>
    </div>
  </div>
</div>
<script src="/public/js/control-panel.js"></script>
</body>
</html>
